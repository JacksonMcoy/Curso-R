---
title: "Introducción al lenguaje  R"
output: 
  html_notebook: 
    highlight: tango
    theme: united
---

## ¿Qué  es R?

* R es un lenguaje y un entorno de  computación y gráficos estadísticos. La página del proyecto es: 
https://www.r-project.org/.
* El entorno de por si, cuenta un gestor de búsqueda : http://www.rseek.org/.
* R ofrece una amplia variedad de técnicas estadísticas :regresión lineal, análisis de series temporales, booststrap, estimación de máxima verosimilitud, etc .

* Como lenguaje de programación  incluye estructuras de programación como :condicionales, bucles, funciones
recursivas definidas por el usuario, etc.  La habilidad para combinar funciones de R, produce una óptima flexibilidad y además resulta de ser  una técnica muy útil. Por ejemplo

```{r}
f <- function (x) {
   c(x=x, floor=floor(x), ceiling=ceiling(x), round=round(x,2), signif=signif(x,2))
 }
 t(apply(t(rt(10,4)),2,f))
```
*  R, puede  realizar  tareas computacionalmente intensivas, vinculando  lenguajes como C, C++ o
Fortran en tiempo de ejecución y mejorar el proceso computacional.

* Posee facilidades gráficas para el análisis y visualización de datos ya sea en pantalla o en
copia impresa como lo realiza la libreria [**ggplot2**](http://ggplot2.org/) de Hadley Wickham.

*  R se maneja por *paquetes*, existe un repositorio oficial de paquetes , organizados por temas:

    https://cran.r-project.org/web/packages/available_packages_by_name.html.
    
* Hay Varios editores están disponibles para trabajar con R:

  - [**RStudio**] (http://www.rstudio.com/ide/).
  - [**Eclipse**] (http://www.walware.de/goto/statet).
  - [**Vim-R-Tmux**] (http://manuals.bioinformatics.ucr.edu/home/programming-in-r/vim-r).


* R hereda de [**S**](http://ect.bell-labs.com/sl/S/), la programación orientada a Objetos, que puede ser útil en problemas de regresión lineal.
* R posee **Polimorfismo**, lo que significa que una única función puede ser aplicada a diferentes tipos de entradas, procesando la función de una manera apropiada en cada caso (*función genérica*). Ejemplo de esto es la función `plot()`.
* Se maneja este paradigma mediantes las clases **Clases S3** y **Clases S4**.

```{r}
library(pryr)

df <- data.frame(x = 1:10, y = letters[1:10])
otype(df) 
```

```{r}
otype(df$x)
```

```{r}
otype(df$y)
```

* R  es un lenguaje de programación funcional (FP), esto significa que proporciona muchas herramientas para la creación y manipulación de las funciones. En particular, R tiene lo que se conoce como **funciones de primera clase**, se puede hacer cualquier cosa con las funciones que se pueden hacer con vectores: se pueden asignar como las variables, almacenarlas en listas, pasarlos como argumentos a otras funciones,etc. Más información en [**funtional programming**](http://adv-r.had.co.nz/Functional-programming.html) de Hadley Wickham.

* Podemos escribir funciones de C/C++ para ser llamadas desde R. Un ejemplo de esto es el uso del protocolo TCP, que hace R.

* R ofrece dos interfaces C/C++ via las funciones `.c()` y `.Call()`. Esta última es más versátil, pero requiere algo de conocimiento de la estructura interna de R. 

* Podemos usar R desde Python, usando **RPy**, una de la más populares interfaces entre esos lenguajes.

* La computación paralela hace uso de varios procesadores que trabajan juntos para resolver un tarea
específica. Las aplicaciones de la computación paralela incluyen resolver determinados problemas:

  - Modelos de simulación.
  - MCMC.
  - Bootstrapping, bigdata, etc.

Más información en el libro de **Parallel R** de Q. Ethan McCallum y Stephen Weston o en el artículo de Daniel Marcelino [**Parallel Processing: When does it worth?**](http://danielmarcelino.com/parallel-processing/).

* R cuenta con una lista de paquetes para la computación en paralelo

  - **Memoria Compartida:** `parallel`, `snow`, `foreach`, `gputools`, `HiPLARM`.
  - **Memoria Distribuida:** `doSnow`, `pbdR`, `Rampi`, `Rhadoop`, `RHIPE`.

* Uno de los  paquetes más importantes que presenta R es  `snow` (un acrónimo de Simple Network of Workstations) que proporciona una interfaz de alto nivel para el uso de cluster en cálculos paralelos en R. Más información en la [**Guia de Usuario de Snow**](http://www.sfu.ca/~sblay/R/snow.html).


##  Vocabulario R

Una parte importante de entender  [R](https://cran.r-project.org/) es tener conocer los objetos que se va a tratar a lo largo del curso. Esta lista  abarca funciones del paquete base, de estructura de datos, de estadísticas, del entornos de R, I/O, etc.

###  Funciones básicas

```
# Primeras funciones a aprender
?
str

#operadores y asignamiento 

%in%, match
=, <-, <<-
$, [, [[, head, tail, subset
with
assign, get

# Comparación 

all.equal, identical
!=, ==, >, >=, <, <=
is.na, complete.cases
is.finite

# Matematica básica

*, +, -, /, ^, %%, %/%
abs, sign
acos, asin, atan, atan2
sin, cos, tan
ceiling, floor, round, trunc, signif
exp, log, log10, log2, sqrt

max, min, prod, sum
cummax, cummin, cumprod, cumsum, diff
pmax, pmin
range
mean, median, cor, sd, var
rle

# Funciones para hacer funciones

function
missing
on.exit
return, invisible

# Lógica & conjuntos

&, |, !, xor
all, any
intersect, union, setdiff, setequal
which

# Vectores y  matrices

c, matrix
# automatica coercion de  character > numeric > logical
length, dim, ncol, nrow
cbind, rbind
names, colnames, rownames
t
diag
sweep
as.matrix, data.matrix

# Vectores 

c
rep, rep_len
seq, seq_len, seq_along
rev
sample
choose, factorial, combn
(is/as).(character/numeric/logical/...)

# Listas & data.frames 

list, unlist
data.frame, as.data.frame
split
expand.grid

# Flujo de control

if, &&, || (short circuiting)
for, while
next, break
switch
ifelse

# Apply y sus amigas

lapply, sapply, vapply
apply
tapply
replicate
```

### Funciones para estructura de datos 

```
# Tiempo

ISOdate, ISOdatetime, strftime, strptime, date
difftime
julian, months, quarters, weekdays
library(lubridate)

# Manipulación de caracteres

grep, agrep
gsub
strsplit
chartr
nchar
tolower, toupper
substr
paste
library(stringr)

# Factores

factor, levels, nlevels
reorder, relevel
cut, findInterval
interaction
options(stringsAsFactors = FALSE)

# Manipulación de arrays

array
dim
dimnames
aperm
library(abind)
```

###  Funciones para Estadística

```
# Ordenacion  y  tabulacion

duplicated, unique
merge
order, rank, quantile
sort
table, ftable

# Modelos lineales

fitted, predict, resid, rstandard
lm, glm
hat, influence.measures
logLik, df, deviance
formula, ~, I
anova, coef, confint, vcov
contrasts

# Miscelanea de Test
apropos("\\.test$")

# Variables aleatorias

(q, p, d, r) * (beta, binom, cauchy, chisq, exp, f, gamma, geom, 
  hyper, lnorm, logis, multinom, nbinom, norm, pois, signrank, t, 
  unif, weibull, wilcox, birthday, tukey)

# Algebra matricial

crossprod, tcrossprod
eigen, qr, svd
%*%, %o%, outer
rcond
solve
```

### Trabajando con  R

```
# Entorno de trabajo

ls, exists, rm
getwd, setwd
q
source
install.packages, library, require

# Ayuda

help, ?
help.search
apropos
RSiteSearch
citation
demo
example
vignette

# Depuracion

traceback
browser
recover
options(error = )
stop, warning, message
tryCatch, try
```

### I/0

```

# Salida

print, cat
message, warning
dput
format
sink, capture.output

# Leyendo y  escribiendo datos

data
count.fields
read.csv, write.csv
read.delim, write.delim
read.fwf
readLines, writeLines
readRDS, saveRDS
load, save
library(foreign)

# Archivos y directorios

dir
basename, dirname, tools::file_ext
file.path
path.expand, normalizePath
file.choose
file.copy, file.create, file.remove, file.rename, dir.create
file.exists, file.info
tempdir, tempfile
download.file, library(downloader)

```
### Ayuda en R

Escribamos una declaración de R

```{r}
mean(1:5)
```

Antes de empezar a escribir el código R, lo más importante es saber cómo obtener ayuda. Hay muchas formas de hacer esto. Por ejemplo

```{r}
?mean 
```

```{r}
?"+" 
```

```{r}
?"if" 
```

```{r}
??plotting 
```

```{r}
??"regression model"
```


Las funciones `help` y `help.search`  hacen  las mismas cosas que `?` y `??`, respectivamente, pero necesitas incluir  argumentos entre comillas. Los siguientes comandos son equivalentes al lote de código anterior

```
help("mean")
help("+")
help("if")
help.search("plotting")
help.search("regression model")
```

La función `apropos` encuentra variables (incluyendo funciones) que coinciden con su entrada. Esto es realmente útil si sólo puede recordar a medias el nombre de una variable que ha creado o una función que desea utilizar. Por ejemplo, supongamos que creamos una variable `a_vector`:

```{r}
a_vector <- c(1, 3, 6, 10, 15)
a_vector
```

```{r}
apropos("vector")
```

Los resultados contienen la variable que acaba de crear, `a_vector` y todas las demás variables que contienen el vector de cadena. En este caso, todas las demás son funciones que están integradas en R.
Encontrar las variables que contienen una cadena en particular está bien, pero también se puede hacer una comparación  con `apropos` utilizando *expresiones regulares*.

Las expresiones regulares son una sintaxis en varios lenguajes que trata de la coincidencia en las cadenas. Se necesita aprender a usarlos. Cambiarán tu vida.

* [Introduction to regular expressions](http://www.regular-expressions.info/quickstart.html).

```{r}
#install.packages("stringr")
library(stringr)
cadenas <- c("a", "ab", "acb", "accb", "acccb", "accccb")
cadenas
grep("ac*b", cadenas, value = TRUE)
grep("ac+b", cadenas, value = TRUE)
grep("ac?b", cadenas, value = TRUE)
grep("ac{2}b", cadenas, value = TRUE)
grep("ac{2,}b", cadenas, value = TRUE)
grep("ac{2,3}b", cadenas, value = TRUE)
stringr::str_extract_all(cadenas, "ac{2,3}b", simplify = TRUE)
```

Un simple uso de `apropos` por ejemplo podría  encontrar todas las variables que terminan en z o encontrar todas las variables que contengan un número entre 4 y 9:

```{r}
apropos("z$")
```

```{r}
apropos("[4-9]")
```

La mayoría de las funciones tienen ejemplos que puedes ejecutar para tener una mejor idea de cómo funcionan. Se utiliza  la función `example` para ejecutarlos. También hay demostraciones  de conceptos que son accesibles con la función `demo`:

```{r}
example("plot")
```

```{r}
demo(Japanese)
```



R es modular y se divide en **paquetes**,  algunos de los cuales contienen *vignettes*, que son documentos cortos sobre cómo usar los paquetes. Se puede explorar todos los  *vignettes*  usando `browseVignettes`:

```{r}
browseVignettes()
```


También puede acceder a un  *vignettes* específico mediante la función `vignette` (pero si su memoria es tan mala como la mía, usar  `browseVignettes` combinado con una búsqueda de página es más fácil que tratar de recordar el nombre de un *vignette* y en qué paquete está):

```{r}
vignette("Sweave", package = "utils")
```

El operador de búsqueda de ayuda `??`  y `browseVignettes` sólo encuentran paquetes que hayan sido instalados. Si se desea buscar cualquier  paquete, puede utilizar `RSiteSearch`, que ejecuta una consulta en http://search.r-project.org. Los términos que tenga varias palabras  necesitan ser escritos entre llaves.

```{r}
RSiteSearch("{Bayesian regression}")
```

Algunos recursos importantes para R, pueden ser:

 -  http://www.r-bloggers.com/. Todo lo referente al ecosistema R, esta aquí, gracias a la contribucion de más o menos 450 bloggers.
 
 - **Stack Overflow**, Es un sitio para encontrar soluciones a problemas informáticos. 
 
  Para R, se tiene el siguiente enlace: http://stackoverflow.com/questions/tagged/r.
 
 - http://zoonek2.free.fr/UNIX/48_R/02.html Uno de los mejores cursos sobre R. Hecho por Vincent Zoonekynd.
